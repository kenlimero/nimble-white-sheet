@use 'variables' as *;

@import 'layout';
@import 'shapes';
@import 'form-aesthetic';
@import 'header';
@import 'stats';
@import 'skills';
@import 'content';

// Sidebar controls (edit toggle, level up/down, rest)
.nos-sidebar-controls {
	position: absolute;
	top: 0;
	right: $nos-gap-md;
	display: flex;
	flex-direction: row;
	gap: $nos-gap-xs;

	.nos-sidebar-btn {
		width: 2rem;
		height: 2rem;
		display: flex;
		align-items: center;
		justify-content: center;
		background: $nos-bg-secondary;
		border: $nos-border-thin;
		border-radius: 2px;
		cursor: pointer;
		font-size: $nos-text-sm;
		color: $nos-text-secondary;
		transition: $nos-transition;

		&:hover {
			background: $nos-highlight;
			color: $nos-text-primary;
		}

		&:disabled {
			opacity: 0.3;
			cursor: default;
		}

		&--active {
			background: $nos-border-color;
			color: $nos-label-text;
		}
	}
}

// Color scheme menu
.nos-color-scheme-wrapper {
	position: relative;
}

.nos-color-scheme-backdrop {
	position: fixed;
	inset: 0;
	z-index: 99;
}

.nos-color-scheme-menu {
	position: absolute;
	top: 100%;
	right: 0;
	margin-top: $nos-gap-xs;
	z-index: 100;
	display: flex;
	flex-direction: column;
	background: $nos-bg-primary;
	border: $nos-border-thin;
	border-radius: 4px;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
	overflow: hidden;
	min-width: 120px;

	&__option {
		display: flex;
		align-items: center;
		gap: $nos-gap-sm;
		padding: $nos-gap-xs $nos-gap-sm;
		background: none;
		border: none;
		cursor: pointer;
		font-size: $nos-text-sm;
		color: $nos-text-secondary;
		white-space: nowrap;
		transition: $nos-transition;

		&:hover {
			background: $nos-highlight;
			color: $nos-text-primary;
		}

		&--active {
			color: $nos-text-primary;
			font-weight: 600;
		}

		i {
			width: 1rem;
			text-align: center;
		}
	}
}

// Dark mode: explicit color overrides
.nos-sheet--dark {
	background: #1a1a1e;
	color: #e0e0e0;

	// Inputs
	input[type='text'],
	input[type='number'] {
		color: #e0e0e0;

		&:focus {
			border-bottom-color: #aaa;
			background: hsl(210, 40%, 25%);
		}
	}

	// Boxes
	.nos-box {
		border-color: #aaa;
		background: #1a1a1e;
	}

	// Labels (pentagons, banners)
	.nos-pentagon,
	.nos-banner {
		background: #ccc;
		color: #1a1a1e;
	}

	// Ability boxes
	.nos-ability__box {
		background: rgba(40, 40, 45, 0.9);
		border-color: #aaa;

		&:hover {
			background: hsl(210, 40%, 25%);
		}
	}

	// Combat stat boxes
	.nos-combat__stat {
		border-color: #aaa;
		background: rgba(40, 40, 45, 0.9);

		&--clickable:hover {
			background: hsl(210, 40%, 25%);
		}
	}

	.nos-combat__pair {
		border-color: #aaa;
		background: rgba(40, 40, 45, 0.9);

		.nos-combat__stat {
			border-color: #aaa;
			background: none;
		}
	}

	.nos-combat__label,
	.nos-combat__icon,
	.nos-combat__sub {
		color: #999;
	}

	.nos-combat__value {
		color: #e0e0e0;
	}

	.nos-combat__input {
		color: #e0e0e0;
	}

	// Skills
	.nos-skill {
		border-right-color: #aaa;

		&:hover {
			background: hsl(210, 40%, 25%);
		}
	}

	.nos-skill__ability {
		color: #999;
	}

	.nos-skills-row {
		border-bottom-color: #aaa;
	}

	// Wounds
	.nos-wounds__label {
		color: #999;
	}

	// Diamonds
	.nos-diamond {
		border-color: #aaa;

		&--active {
			background: #aaa;
		}
	}

	// Header
	.nos-header__hitdie {
		border-color: #aaa;
		background: rgba(40, 40, 45, 0.9);
	}

	.nos-header__name label,
	.nos-header__meta label,
	.nos-header__hitdie label {
		color: #999;
	}

	// Resources
	.nos-resources__label {
		color: #999;
	}

	// Content area
	.nos-content__tabs {
		border-bottom-color: #aaa;
	}

	.nos-content__sidebar-header {
		border-left-color: #aaa;
		border-bottom-color: #aaa;

		span {
			color: #999;
		}
	}

	.nos-content__sidebar {
		border-left-color: #aaa;
	}

	// Tab buttons
	.nos-tab-btn {
		color: #999;

		&:hover {
			color: #e0e0e0;
		}

		&--active {
			color: #e0e0e0;
			border-bottom-color: #aaa;
		}
	}

	// Items
	.nos-item {
		border-bottom-color: #333;

		&:hover {
			background: hsl(210, 40%, 25%);
		}
	}

	.nos-item__meta {
		color: #999;
	}

	// Slots
	.nos-slot {
		border-bottom-color: #666;

		&--empty {
			color: #999;
		}
	}

	// Rollable
	.nos-rollable:hover {
		background: hsl(210, 40%, 25%);
	}

	// Icon buttons
	.nos-icon-btn {
		color: #999;

		&:hover {
			color: #e0e0e0;
		}
	}

	// Currency
	.nos-currency {
		border-bottom-color: #666;
	}

	.nos-currency__coin label {
		color: #999;
	}

	.nos-currency__btn {
		color: #999;
		border-color: #666;

		&:hover {
			color: #e0e0e0;
			border-color: #aaa;
		}
	}

	// Bio
	.nos-bio__field label {
		color: #999;
	}

	.nos-bio__notes-editor {
		border-color: #666;
		background: #1a1a1e;
		color: #e0e0e0;
	}

	// Spell tiers / Feature groups
	.nos-spell-tier__heading,
	.nos-feature-group__heading {
		color: #999;
		border-bottom-color: #aaa;
	}

	// Search
	.nos-search input {
		color: #e0e0e0;
	}

	// Sidebar buttons
	.nos-sidebar-btn {
		background: #252529;
		border-color: #aaa;
		color: #999;

		&:hover {
			background: hsl(210, 40%, 25%);
			color: #e0e0e0;
		}

		&--active {
			background: #ccc;
			color: #1a1a1e;
		}
	}

	// Color scheme menu
	.nos-color-scheme-menu {
		background: #252529;
		border-color: #aaa;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);

		&__option {
			color: #999;

			&:hover {
				background: hsl(210, 40%, 25%);
				color: #e0e0e0;
			}

			&--active {
				color: #e0e0e0;
			}
		}
	}

	// Logo
	.nos-logo {
		color: #666;
	}
}

// Nimble v2 color scheme: uses the system's CSS custom properties
// These variables are set on :root by the Nimble system and overridden by .theme-dark
.nos-sheet--nimble {
	background: var(--nimble-sheet-background);
	color: var(--nimble-dark-text-color);

	// Inputs
	input[type='text'],
	input[type='number'] {
		color: var(--nimble-dark-text-color);

		&:focus {
			border-bottom-color: var(--nimble-input-border-color);
			background: var(--nimble-input-background-color);
		}
	}

	// Boxes
	.nos-box {
		border-color: var(--nimble-box-color);
		background: var(--nimble-box-background-color);
	}

	// Labels (pentagons, banners)
	.nos-pentagon,
	.nos-banner {
		background: var(--nimble-navigation-background-color);
		color: var(--nimble-navigation-text-color);
	}

	// Ability boxes
	.nos-ability__box {
		background: var(--nimble-box-background-color);
		border-color: var(--nimble-box-color);

		&:hover {
			background: var(--nimble-input-background-color);
		}
	}

	// Combat stat boxes
	.nos-combat__stat {
		border-color: var(--nimble-box-color);
		background: var(--nimble-box-background-color);

		&--clickable:hover {
			background: var(--nimble-input-background-color);
		}
	}

	.nos-combat__pair {
		border-color: var(--nimble-box-color);
		background: var(--nimble-box-background-color);

		.nos-combat__stat {
			border-color: var(--nimble-box-color);
			background: none;
		}
	}

	.nos-combat__label,
	.nos-combat__icon,
	.nos-combat__sub {
		color: var(--nimble-medium-text-color);
	}

	.nos-combat__value {
		color: var(--nimble-dark-text-color);
	}

	.nos-combat__input {
		color: var(--nimble-dark-text-color);
	}

	// Skills
	.nos-skill {
		border-right-color: var(--nimble-box-color);

		&:hover {
			background: var(--nimble-input-background-color);
		}
	}

	.nos-skill__ability {
		color: var(--nimble-medium-text-color);
	}

	.nos-skills-row {
		border-bottom-color: var(--nimble-box-color);
	}

	// Wounds
	.nos-wounds__label {
		color: var(--nimble-medium-text-color);
	}

	// Diamonds
	.nos-diamond {
		border-color: var(--nimble-box-color);

		&--active {
			background: var(--nimble-box-color);
		}
	}

	// Header
	.nos-header__hitdie {
		border-color: var(--nimble-box-color);
		background: var(--nimble-box-background-color);
	}

	.nos-header__name label,
	.nos-header__meta label,
	.nos-header__hitdie label {
		color: var(--nimble-medium-text-color);
	}

	// Resources
	.nos-resources__label {
		color: var(--nimble-medium-text-color);
	}

	// Content area
	.nos-content__tabs {
		border-bottom-color: var(--nimble-box-color);
	}

	.nos-content__sidebar-header {
		border-left-color: var(--nimble-box-color);
		border-bottom-color: var(--nimble-box-color);

		span {
			color: var(--nimble-medium-text-color);
		}
	}

	.nos-content__sidebar {
		border-left-color: var(--nimble-box-color);
	}

	// Tab buttons
	.nos-tab-btn {
		color: var(--nimble-medium-text-color);

		&:hover {
			color: var(--nimble-dark-text-color);
		}

		&--active {
			color: var(--nimble-dark-text-color);
			border-bottom-color: var(--nimble-box-color);
		}
	}

	// Items
	.nos-item {
		border-bottom-color: var(--nimble-card-border-color);

		&:hover {
			background: var(--nimble-input-background-color);
		}
	}

	.nos-item__meta {
		color: var(--nimble-medium-text-color);
	}

	// Slots
	.nos-slot {
		border-bottom-color: var(--nimble-card-border-color);

		&--empty {
			color: var(--nimble-medium-text-color);
		}
	}

	// Rollable
	.nos-rollable:hover {
		background: var(--nimble-input-background-color);
	}

	// Icon buttons
	.nos-icon-btn {
		color: var(--nimble-medium-text-color);

		&:hover {
			color: var(--nimble-dark-text-color);
		}
	}

	// Currency
	.nos-currency {
		border-bottom-color: var(--nimble-card-border-color);
	}

	.nos-currency__coin label {
		color: var(--nimble-medium-text-color);
	}

	.nos-currency__btn {
		color: var(--nimble-medium-text-color);
		border-color: var(--nimble-card-border-color);

		&:hover {
			color: var(--nimble-dark-text-color);
			border-color: var(--nimble-box-color);
		}
	}

	// Bio
	.nos-bio__field label {
		color: var(--nimble-medium-text-color);
	}

	.nos-bio__notes-editor {
		border-color: var(--nimble-box-color);
		background: var(--nimble-box-background-color);
		color: var(--nimble-dark-text-color);
	}

	// Spell tiers / Feature groups
	.nos-spell-tier__heading,
	.nos-feature-group__heading {
		color: var(--nimble-medium-text-color);
		border-bottom-color: var(--nimble-box-color);
	}

	// Search
	.nos-search input {
		color: var(--nimble-dark-text-color);
	}

	// Sidebar buttons
	.nos-sidebar-btn {
		background: var(--nimble-box-background-color);
		border-color: var(--nimble-box-color);
		color: var(--nimble-medium-text-color);

		&:hover {
			background: var(--nimble-input-background-color);
			color: var(--nimble-dark-text-color);
		}

		&--active {
			background: var(--nimble-navigation-background-color);
			color: var(--nimble-navigation-text-color);
		}
	}

	// Color scheme menu
	.nos-color-scheme-menu {
		background: var(--nimble-box-background-color);
		border-color: var(--nimble-box-color);

		&__option {
			color: var(--nimble-medium-text-color);

			&:hover {
				background: var(--nimble-input-background-color);
				color: var(--nimble-dark-text-color);
			}

			&--active {
				color: var(--nimble-dark-text-color);
			}
		}
	}

	// Logo
	.nos-logo {
		color: var(--nimble-medium-text-color);
	}
}

// Custom color scheme: uses inline CSS custom properties (--nos-*)
.nos-sheet--custom {
	background: var(--nos-bg-primary);
	color: var(--nos-text-primary);

	// Inputs
	input[type='text'],
	input[type='number'] {
		color: var(--nos-text-primary);

		&:focus {
			border-bottom-color: var(--nos-border-light);
			background: var(--nos-highlight);
		}
	}

	// Boxes
	.nos-box {
		border-color: var(--nos-border-color);
		background: var(--nos-bg-primary);
	}

	// Labels (pentagons, banners)
	.nos-pentagon,
	.nos-banner {
		background: var(--nos-label-bg);
		color: var(--nos-label-text);
	}

	// Ability boxes
	.nos-ability__box {
		background: var(--nos-bg-secondary);
		border-color: var(--nos-border-color);

		&:hover {
			background: var(--nos-highlight);
		}
	}

	// Combat stat boxes
	.nos-combat__stat {
		border-color: var(--nos-border-color);
		background: var(--nos-bg-secondary);

		&--clickable:hover {
			background: var(--nos-highlight);
		}
	}

	.nos-combat__pair {
		border-color: var(--nos-border-color);
		background: var(--nos-bg-secondary);

		.nos-combat__stat {
			border-color: var(--nos-border-color);
			background: none;
		}
	}

	.nos-combat__label,
	.nos-combat__icon,
	.nos-combat__sub {
		color: var(--nos-text-secondary);
	}

	.nos-combat__value {
		color: var(--nos-text-primary);
	}

	.nos-combat__input {
		color: var(--nos-text-primary);
	}

	// Skills
	.nos-skill {
		border-right-color: var(--nos-border-color);

		&:hover {
			background: var(--nos-highlight);
		}
	}

	.nos-skill__ability {
		color: var(--nos-text-secondary);
	}

	.nos-skills-row {
		border-bottom-color: var(--nos-border-color);
	}

	// Wounds
	.nos-wounds__label {
		color: var(--nos-text-secondary);
	}

	// Diamonds
	.nos-diamond {
		border-color: var(--nos-border-color);

		&--active {
			background: var(--nos-border-color);
		}
	}

	// Header
	.nos-header__hitdie {
		border-color: var(--nos-border-color);
		background: var(--nos-bg-secondary);
	}

	.nos-header__name label,
	.nos-header__meta label,
	.nos-header__hitdie label {
		color: var(--nos-text-secondary);
	}

	// Resources
	.nos-resources__label {
		color: var(--nos-text-secondary);
	}

	// Content area
	.nos-content__tabs {
		border-bottom-color: var(--nos-border-color);
	}

	.nos-content__sidebar-header {
		border-left-color: var(--nos-border-color);
		border-bottom-color: var(--nos-border-color);

		span {
			color: var(--nos-text-secondary);
		}
	}

	.nos-content__sidebar {
		border-left-color: var(--nos-border-color);
	}

	// Tab buttons
	.nos-tab-btn {
		color: var(--nos-text-secondary);

		&:hover {
			color: var(--nos-text-primary);
		}

		&--active {
			color: var(--nos-text-primary);
			border-bottom-color: var(--nos-border-color);
		}
	}

	// Items
	.nos-item {
		border-bottom-color: var(--nos-border-light);

		&:hover {
			background: var(--nos-highlight);
		}
	}

	.nos-item__meta {
		color: var(--nos-text-secondary);
	}

	// Slots
	.nos-slot {
		border-bottom-color: var(--nos-border-light);

		&--empty {
			color: var(--nos-text-secondary);
		}
	}

	// Rollable
	.nos-rollable:hover {
		background: var(--nos-highlight);
	}

	// Icon buttons
	.nos-icon-btn {
		color: var(--nos-text-secondary);

		&:hover {
			color: var(--nos-text-primary);
		}
	}

	// Currency
	.nos-currency {
		border-bottom-color: var(--nos-border-light);
	}

	.nos-currency__coin label {
		color: var(--nos-text-secondary);
	}

	.nos-currency__btn {
		color: var(--nos-text-secondary);
		border-color: var(--nos-border-light);

		&:hover {
			color: var(--nos-text-primary);
			border-color: var(--nos-border-color);
		}
	}

	// Bio
	.nos-bio__field label {
		color: var(--nos-text-secondary);
	}

	.nos-bio__notes-editor {
		border-color: var(--nos-border-light);
		background: var(--nos-bg-input);
		color: var(--nos-text-primary);
	}

	// Spell tiers / Feature groups
	.nos-spell-tier__heading,
	.nos-feature-group__heading {
		color: var(--nos-text-secondary);
		border-bottom-color: var(--nos-border-color);
	}

	// Search
	.nos-search input {
		color: var(--nos-text-primary);
	}

	// Sidebar buttons
	.nos-sidebar-btn {
		background: var(--nos-bg-secondary);
		border-color: var(--nos-border-color);
		color: var(--nos-text-secondary);

		&:hover {
			background: var(--nos-highlight);
			color: var(--nos-text-primary);
		}

		&--active {
			background: var(--nos-label-bg);
			color: var(--nos-label-text);
		}
	}

	// Color scheme menu
	.nos-color-scheme-menu {
		background: var(--nos-bg-primary);
		border-color: var(--nos-border-color);

		&__option {
			color: var(--nos-text-secondary);

			&:hover {
				background: var(--nos-highlight);
				color: var(--nos-text-primary);
			}

			&--active {
				color: var(--nos-text-primary);
			}
		}
	}

	// Logo
	.nos-logo {
		color: var(--nos-border-light);
	}
}

// Color picker panel inside color scheme menu
.nos-color-picker-panel {
	display: flex;
	flex-direction: column;
	gap: $nos-gap-xs;
	padding: $nos-gap-sm;
	border-top: $nos-border-light-thin;
	max-height: 300px;
	overflow-y: auto;
}

.nos-color-picker-group {
	display: flex;
	flex-direction: column;
	gap: $nos-gap-xs;

	&__label {
		font-size: $nos-text-xs;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.05em;
		opacity: 0.7;
	}

	&__colors {
		display: flex;
		flex-direction: column;
		gap: 1px;
	}
}

.nos-color-picker {
	display: flex;
	align-items: center;
	gap: $nos-gap-sm;
	cursor: pointer;
	font-size: $nos-text-xs;
	padding: 1px 0;

	input[type='color'] {
		-webkit-appearance: none;
		appearance: none;
		width: 20px;
		height: 20px;
		border: 1px solid $nos-border-light;
		border-radius: 3px;
		padding: 1px;
		cursor: pointer;
		background: none;

		&::-webkit-color-swatch-wrapper {
			padding: 0;
		}

		&::-webkit-color-swatch {
			border: none;
			border-radius: 2px;
		}
	}

	span {
		white-space: nowrap;
	}
}

// Nimble logo at bottom-right
.nos-logo {
	position: absolute;
	bottom: $nos-gap-sm;
	right: $nos-gap-md;
	font-size: $nos-text-xs;
	color: $nos-border-light;
	font-weight: 700;
	font-style: italic;
	opacity: 0.5;
	pointer-events: none;
}
